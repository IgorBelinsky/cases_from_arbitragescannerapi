@page "/"
@inject HttpClient Http
@using System.Net.Http.Json
@using MudBlazor

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h5">Пример запроса к JSONPlaceholder</MudText>
    <MudDivider Class="my-2" />
    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="Load">Загрузить пост #1</MudButton>
    
    @if (loading)
    {
        <MudProgressCircular Indeterminate="true" Class="mx-2" />
    }

    @if (post is not null)
    {
        <MudCard Class="mt-4">
            <MudCardContent>
                <MudText Typo="Typo.h6">@post.title</MudText>
                <MudText>@post.body</MudText>
            </MudCardContent>
        </MudCard>
    }
</MudPaper>

@code {
    bool loading = false;
    Post? post;

    async Task Load() {
        loading = true;
        try {
            post = await Http.GetFromJsonAsync<Post>("https://jsonplaceholder.typicode.com/posts/1");
        }
        finally {
            loading = false;
        }
    }

    class Post {
        public int userId { get; set; }
        public int id { get; set; }
        public string? title { get; set; }
        public string? body { get; set; }
    }
}
